{"ast":null,"code":"import React,{createContext,useContext,useEffect,useState}from'react';import{onAuthStateChanged,signOut as firebaseSignOut}from'firebase/auth';import{auth}from'../firebase';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext({currentUser:null,loading:true,token:null,signOut:async()=>{}});export const AuthProvider=_ref=>{let{children}=_ref;const[currentUser,setCurrentUser]=useState(null);const[loading,setLoading]=useState(true);const[token,setToken]=useState(null);const signOut=async()=>{await firebaseSignOut(auth);setToken(null);localStorage.removeItem('token');};useEffect(()=>{const unsubscribe=onAuthStateChanged(auth,async user=>{setCurrentUser(user);if(user){try{const token=await user.getIdToken();setToken(token);localStorage.setItem('token',token);}catch(error){console.error('Error getting user token:',error);setToken(null);localStorage.removeItem('token');}}else{setToken(null);localStorage.removeItem('token');}setLoading(false);});// Cleanup subscription on unmount\nreturn()=>unsubscribe();},[]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{currentUser,loading,token,signOut},children:!loading&&children});};export const useAuth=()=>{return useContext(AuthContext);};export default AuthContext;","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","onAuthStateChanged","signOut","firebaseSignOut","auth","jsx","_jsx","AuthContext","currentUser","loading","token","AuthProvider","_ref","children","setCurrentUser","setLoading","setToken","localStorage","removeItem","unsubscribe","user","getIdToken","setItem","error","console","Provider","value","useAuth"],"sources":["C:/Users/User/notefusion-ai/notefusion-ai/frontend/src/contexts/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\nimport { getAuth, onAuthStateChanged, User, signOut as firebaseSignOut } from 'firebase/auth';\nimport { auth } from '../firebase';\n\ninterface AuthContextType {\n  currentUser: User | null;\n  loading: boolean;\n  token: string | null;\n  signOut: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType>({\n  currentUser: null,\n  loading: true,\n  token: null,\n  signOut: async () => {},\n});\n\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [token, setToken] = useState<string | null>(null);\n\n  const signOut = async () => {\n    await firebaseSignOut(auth);\n    setToken(null);\n    localStorage.removeItem('token');\n  };\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (user) => {\n      setCurrentUser(user);\n      \n      if (user) {\n        try {\n          const token = await user.getIdToken();\n          setToken(token);\n          localStorage.setItem('token', token);\n        } catch (error) {\n          console.error('Error getting user token:', error);\n          setToken(null);\n          localStorage.removeItem('token');\n        }\n      } else {\n        setToken(null);\n        localStorage.removeItem('token');\n      }\n      \n      setLoading(false);\n    });\n\n    // Cleanup subscription on unmount\n    return () => unsubscribe();\n  }, []);\n\n  return (\n    <AuthContext.Provider value={{ currentUser, loading, token, signOut }}>\n      {!loading && children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => {\n  return useContext(AuthContext);\n};\n\nexport default AuthContext;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC7E,OAAkBC,kBAAkB,CAAQC,OAAO,GAAI,CAAAC,eAAe,KAAQ,eAAe,CAC7F,OAASC,IAAI,KAAQ,aAAa,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBASnC,KAAM,CAAAC,WAAW,cAAGV,aAAa,CAAkB,CACjDW,WAAW,CAAE,IAAI,CACjBC,OAAO,CAAE,IAAI,CACbC,KAAK,CAAE,IAAI,CACXR,OAAO,CAAE,KAAAA,CAAA,GAAY,CAAC,CACxB,CAAC,CAAC,CAEF,MAAO,MAAM,CAAAS,YAAqD,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAChF,KAAM,CAACJ,WAAW,CAAEM,cAAc,CAAC,CAAGd,QAAQ,CAAc,IAAI,CAAC,CACjE,KAAM,CAACS,OAAO,CAAEM,UAAU,CAAC,CAAGf,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACU,KAAK,CAAEM,QAAQ,CAAC,CAAGhB,QAAQ,CAAgB,IAAI,CAAC,CAEvD,KAAM,CAAAE,OAAO,CAAG,KAAAA,CAAA,GAAY,CAC1B,KAAM,CAAAC,eAAe,CAACC,IAAI,CAAC,CAC3BY,QAAQ,CAAC,IAAI,CAAC,CACdC,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC,CAClC,CAAC,CAEDnB,SAAS,CAAC,IAAM,CACd,KAAM,CAAAoB,WAAW,CAAGlB,kBAAkB,CAACG,IAAI,CAAE,KAAO,CAAAgB,IAAI,EAAK,CAC3DN,cAAc,CAACM,IAAI,CAAC,CAEpB,GAAIA,IAAI,CAAE,CACR,GAAI,CACF,KAAM,CAAAV,KAAK,CAAG,KAAM,CAAAU,IAAI,CAACC,UAAU,CAAC,CAAC,CACrCL,QAAQ,CAACN,KAAK,CAAC,CACfO,YAAY,CAACK,OAAO,CAAC,OAAO,CAAEZ,KAAK,CAAC,CACtC,CAAE,MAAOa,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACjDP,QAAQ,CAAC,IAAI,CAAC,CACdC,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC,CAClC,CACF,CAAC,IAAM,CACLF,QAAQ,CAAC,IAAI,CAAC,CACdC,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC,CAClC,CAEAH,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAC,CAEF;AACA,MAAO,IAAMI,WAAW,CAAC,CAAC,CAC5B,CAAC,CAAE,EAAE,CAAC,CAEN,mBACEb,IAAA,CAACC,WAAW,CAACkB,QAAQ,EAACC,KAAK,CAAE,CAAElB,WAAW,CAAEC,OAAO,CAAEC,KAAK,CAAER,OAAQ,CAAE,CAAAW,QAAA,CACnE,CAACJ,OAAO,EAAII,QAAQ,CACD,CAAC,CAE3B,CAAC,CAED,MAAO,MAAM,CAAAc,OAAO,CAAGA,CAAA,GAAM,CAC3B,MAAO,CAAA7B,UAAU,CAACS,WAAW,CAAC,CAChC,CAAC,CAED,cAAe,CAAAA,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}