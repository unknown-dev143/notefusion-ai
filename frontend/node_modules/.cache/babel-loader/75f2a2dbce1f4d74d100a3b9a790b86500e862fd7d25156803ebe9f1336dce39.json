{"ast":null,"code":"import React,{useCallback,useRef,useState,useEffect}from'react';// @ts-ignore - Missing type definitions for react-canvas-draw\nimport CanvasDraw from'react-canvas-draw';import{FiSave,FiTrash2,FiRotateCcw,FiDownload,FiPenTool,FiType,FiSquare,FiCircle,FiMinus,FiX}from'react-icons/fi';// Define the CanvasDraw ref type\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DiagramCanvas=_ref=>{let{onSave,initialData,autoSave=false,onAutoSave}=_ref;const[canvas,setCanvas]=useState(null);const[brushColor,setBrushColor]=useState(\"#222222\");const[brushRadius,setBrushRadius]=useState(2);const[activeTool,setActiveTool]=useState('pen');const[showColorPicker,setShowColorPicker]=useState(false);const[isDrawing,setIsDrawing]=useState(false);const[startPos,setStartPos]=useState({x:0,y:0});const[textInput,setTextInput]=useState('');const[showTextInput,setShowTextInput]=useState(false);const[textPosition,setTextPosition]=useState({x:0,y:0});const fileDownloadRef=useRef(null);const canvasRef=useRef(null);const canvasContainerRef=useRef(null);const colors=['#000000','#ff0000','#00ff00','#0000ff','#ffff00','#00ffff','#ff00ff','#ffffff'];const brushSizes=[1,2,4,8,12,16];// Auto-save functionality\nuseEffect(()=>{if(autoSave&&canvasRef.current){const data=canvasRef.current.getSaveData();onAutoSave===null||onAutoSave===void 0?void 0:onAutoSave(data);}},[autoSave,onAutoSave]);// Handle mouse down for shapes\nconst handleMouseDown=e=>{if(!canvasRef.current||!canvasContainerRef.current)return;const rect=canvasContainerRef.current.getBoundingClientRect();const x=e.clientX-rect.left;const y=e.clientY-rect.top;setStartPos({x,y});if(activeTool==='text'){setTextPosition({x,y});setShowTextInput(true);return;}setIsDrawing(true);};// Handle mouse move for drawing shapes\nconst handleMouseMove=e=>{if(!isDrawing||!canvasRef.current||!canvasContainerRef.current)return;const rect=canvasContainerRef.current.getBoundingClientRect();const x=e.clientX-rect.left;const y=e.clientY-rect.top;// In a real implementation, you would draw the shape on a temporary canvas\n// and only commit to the main canvas on mouse up\n};// Handle mouse up to complete shape drawing\nconst handleMouseUp=()=>{if(!isDrawing)return;setIsDrawing(false);// In a real implementation, you would finalize the shape here\n// and add it to the canvas\n};// Handle text input submission\nconst handleTextSubmit=()=>{if(!canvasRef.current||!textInput.trim()){setShowTextInput(false);return;}// In a real implementation, you would add the text to the canvas at textPosition\n// This is a simplified version that just alerts the text\nalert(`Text to add: ${textInput}`);setTextInput('');setShowTextInput(false);};const handleSave=useCallback(()=>{if(canvas){const data=canvas.getSaveData();onSave(data);}},[canvas,onSave]);const handleClear=useCallback(()=>{if(canvas){canvas.clear();}},[canvas]);const handleUndo=useCallback(()=>{if(canvas){canvas.undo();}},[canvas]);const handleExport=useCallback(()=>{if(canvas&&canvas.canvas){const dataUrl=canvas.canvas.toDataURL(\"image/png\");if(fileDownloadRef.current){fileDownloadRef.current.href=dataUrl;fileDownloadRef.current.download=\"whiteboard.png\";fileDownloadRef.current.click();}}},[canvas]);const handleBrushColor=e=>{setBrushColor(e.target.value);setActiveTool('pen');};const handleBrushRadius=e=>{setBrushRadius(Number(e.target.value));};return/*#__PURE__*/_jsx(\"div\",{className:\"border rounded-lg p-4 bg-white\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap justify-between items-center gap-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold\",children:\"Whiteboard\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1 p-1 bg-gray-100 rounded-md\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTool('pen'),className:`p-2 rounded ${activeTool==='pen'?'bg-white shadow':'hover:bg-gray-200'}`,title:\"Pen\",children:/*#__PURE__*/_jsx(FiPenTool,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTool('eraser'),className:`p-2 rounded ${activeTool==='eraser'?'bg-white shadow':'hover:bg-gray-200'}`,title:\"Eraser\",children:/*#__PURE__*/_jsx(FiX,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTool('text'),className:`p-2 rounded ${activeTool==='text'?'bg-white shadow':'hover:bg-gray-200'}`,title:\"Add Text\",children:/*#__PURE__*/_jsx(FiType,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTool('rectangle'),className:`p-2 rounded ${activeTool==='rectangle'?'bg-white shadow':'hover:bg-gray-200'}`,title:\"Rectangle\",children:/*#__PURE__*/_jsx(FiSquare,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTool('circle'),className:`p-2 rounded ${activeTool==='circle'?'bg-white shadow':'hover:bg-gray-200'}`,title:\"Circle\",children:/*#__PURE__*/_jsx(FiCircle,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTool('line'),className:`p-2 rounded ${activeTool==='line'?'bg-white shadow':'hover:bg-gray-200'}`,title:\"Line\",children:/*#__PURE__*/_jsx(FiMinus,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowColorPicker(!showColorPicker),className:\"w-8 h-8 rounded border border-gray-300\",style:{backgroundColor:brushColor},title:\"Select color\"}),showColorPicker&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-10 mt-2 p-2 bg-white rounded shadow-lg\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-4 gap-2\",children:colors.map(color=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setBrushColor(color);setShowColorPicker(false);setActiveTool('pen');},className:\"w-6 h-6 rounded border border-gray-300\",style:{backgroundColor:color},title:color},color))})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:\"Size:\"}),/*#__PURE__*/_jsx(\"select\",{value:brushRadius,onChange:e=>setBrushRadius(Number(e.target.value)),className:\"text-sm border rounded p-1\",children:brushSizes.map(size=>/*#__PURE__*/_jsx(\"option\",{value:size,children:size},size))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleUndo,className:\"p-2 text-gray-700 hover:bg-gray-200 rounded\",title:\"Undo\",children:/*#__PURE__*/_jsx(FiRotateCcw,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClear,className:\"p-2 text-gray-700 hover:bg-gray-200 rounded\",title:\"Clear\",children:/*#__PURE__*/_jsx(FiTrash2,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,className:\"p-2 bg-blue-500 text-white rounded hover:bg-blue-600\",title:\"Save\",children:/*#__PURE__*/_jsx(FiSave,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleExport,className:\"p-2 bg-green-500 text-white rounded hover:bg-green-600\",title:\"Export\",children:/*#__PURE__*/_jsx(FiDownload,{className:\"w-5 h-5\"})}),/*#__PURE__*/_jsx(\"a\",{ref:fileDownloadRef,style:{display:'none'},children:\"Download\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{ref:canvasContainerRef,className:\"relative border rounded bg-white\",style:{width:'100%',height:'500px',overflow:'hidden'},onMouseDown:handleMouseDown,onMouseMove:handleMouseMove,onMouseUp:handleMouseUp,onMouseLeave:handleMouseUp,children:[/*#__PURE__*/_jsx(CanvasDraw,{ref:canvasDraw=>{if(canvasDraw){setCanvas(canvasDraw);canvasRef.current=canvasDraw;}},brushColor:activeTool==='eraser'?'#fff':brushColor,brushRadius:brushRadius,lazyRadius:0,saveData:initialData,style:{width:'100%',height:'100%',touchAction:'none'},canvasWidth:800,canvasHeight:500}),showTextInput&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',left:`${textPosition.x}px`,top:`${textPosition.y}px`,zIndex:1000},children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex bg-white border rounded shadow-lg p-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:textInput,onChange:e=>setTextInput(e.target.value),onKeyDown:e=>e.key==='Enter'&&handleTextSubmit(),className:\"border rounded px-2 py-1 mr-2\",autoFocus:true,placeholder:\"Enter text...\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleTextSubmit,className:\"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600\",children:\"Add\"})]})})]})]})});};export default DiagramCanvas;","map":{"version":3,"names":["React","useCallback","useRef","useState","useEffect","CanvasDraw","FiSave","FiTrash2","FiRotateCcw","FiDownload","FiPenTool","FiType","FiSquare","FiCircle","FiMinus","FiX","jsx","_jsx","jsxs","_jsxs","DiagramCanvas","_ref","onSave","initialData","autoSave","onAutoSave","canvas","setCanvas","brushColor","setBrushColor","brushRadius","setBrushRadius","activeTool","setActiveTool","showColorPicker","setShowColorPicker","isDrawing","setIsDrawing","startPos","setStartPos","x","y","textInput","setTextInput","showTextInput","setShowTextInput","textPosition","setTextPosition","fileDownloadRef","canvasRef","canvasContainerRef","colors","brushSizes","current","data","getSaveData","handleMouseDown","e","rect","getBoundingClientRect","clientX","left","clientY","top","handleMouseMove","handleMouseUp","handleTextSubmit","trim","alert","handleSave","handleClear","clear","handleUndo","undo","handleExport","dataUrl","toDataURL","href","download","click","handleBrushColor","target","value","handleBrushRadius","Number","className","children","onClick","title","style","backgroundColor","map","color","onChange","size","ref","display","width","height","overflow","onMouseDown","onMouseMove","onMouseUp","onMouseLeave","canvasDraw","lazyRadius","saveData","touchAction","canvasWidth","canvasHeight","position","zIndex","type","onKeyDown","key","autoFocus","placeholder"],"sources":["C:/Users/User/notefusion-ai/notefusion-ai/frontend/src/components/DiagramCanvas.tsx"],"sourcesContent":["import React, { useCallback, useRef, useState, useEffect, RefObject } from 'react';\r\n// @ts-ignore - Missing type definitions for react-canvas-draw\r\nimport CanvasDraw from 'react-canvas-draw';\r\nimport { FiSave, FiTrash2, FiRotateCcw, FiDownload, FiPenTool, FiType, FiSquare, FiCircle, FiMinus, FiX } from 'react-icons/fi';\r\n\r\ntype Tool = 'pen' | 'eraser' | 'text' | 'rectangle' | 'circle' | 'line';\r\n\r\n// Define the CanvasDraw ref type\r\ninterface CanvasDrawRef {\r\n  clear: () => void;\r\n  undo: () => void;\r\n  getSaveData: () => string;\r\n  loadSaveData: (saveData: string, immediate?: boolean) => void;\r\n  canvas: HTMLCanvasElement;\r\n  canvasContainer: HTMLDivElement;\r\n  ctx: CanvasRenderingContext2D;\r\n  drawing: HTMLCanvasElement;\r\n}\r\n\r\ninterface DiagramCanvasProps {\r\n  onSave: (data: string) => void;\r\n  initialData?: string;\r\n  autoSave?: boolean;\r\n  onAutoSave?: (data: string) => void;\r\n}\r\n\r\nconst DiagramCanvas: React.FC<DiagramCanvasProps> = ({ \r\n  onSave, \r\n  initialData, \r\n  autoSave = false,\r\n  onAutoSave\r\n}) => {\r\n  const [canvas, setCanvas] = useState<CanvasDrawRef | null>(null);\r\n  const [brushColor, setBrushColor] = useState<string>(\"#222222\");\r\n  const [brushRadius, setBrushRadius] = useState<number>(2);\r\n  const [activeTool, setActiveTool] = useState<Tool>('pen');\r\n  const [showColorPicker, setShowColorPicker] = useState(false);\r\n  const [isDrawing, setIsDrawing] = useState(false);\r\n  const [startPos, setStartPos] = useState({ x: 0, y: 0 });\r\n  const [textInput, setTextInput] = useState('');\r\n  const [showTextInput, setShowTextInput] = useState(false);\r\n  const [textPosition, setTextPosition] = useState({ x: 0, y: 0 });\r\n  const fileDownloadRef = useRef<HTMLAnchorElement>(null);\r\n  const canvasRef = useRef<CanvasDrawRef>(null);\r\n  const canvasContainerRef = useRef<HTMLDivElement>(null);\r\n\r\n  const colors = [\r\n    '#000000', '#ff0000', '#00ff00', '#0000ff', \r\n    '#ffff00', '#00ffff', '#ff00ff', '#ffffff'\r\n  ];\r\n\r\n  const brushSizes = [1, 2, 4, 8, 12, 16];\r\n\r\n  // Auto-save functionality\r\n  useEffect(() => {\r\n    if (autoSave && canvasRef.current) {\r\n      const data = canvasRef.current.getSaveData();\r\n      onAutoSave?.(data);\r\n    }\r\n  }, [autoSave, onAutoSave]);\r\n\r\n  // Handle mouse down for shapes\r\n  const handleMouseDown = (e: React.MouseEvent) => {\r\n    if (!canvasRef.current || !canvasContainerRef.current) return;\r\n    \r\n    const rect = canvasContainerRef.current.getBoundingClientRect();\r\n    const x = e.clientX - rect.left;\r\n    const y = e.clientY - rect.top;\r\n    \r\n    setStartPos({ x, y });\r\n    \r\n    if (activeTool === 'text') {\r\n      setTextPosition({ x, y });\r\n      setShowTextInput(true);\r\n      return;\r\n    }\r\n    \r\n    setIsDrawing(true);\r\n  };\r\n  \r\n  // Handle mouse move for drawing shapes\r\n  const handleMouseMove = (e: React.MouseEvent) => {\r\n    if (!isDrawing || !canvasRef.current || !canvasContainerRef.current) return;\r\n    \r\n    const rect = canvasContainerRef.current.getBoundingClientRect();\r\n    const x = e.clientX - rect.left;\r\n    const y = e.clientY - rect.top;\r\n    \r\n    // In a real implementation, you would draw the shape on a temporary canvas\r\n    // and only commit to the main canvas on mouse up\r\n  };\r\n  \r\n  // Handle mouse up to complete shape drawing\r\n  const handleMouseUp = () => {\r\n    if (!isDrawing) return;\r\n    setIsDrawing(false);\r\n    \r\n    // In a real implementation, you would finalize the shape here\r\n    // and add it to the canvas\r\n  };\r\n  \r\n  // Handle text input submission\r\n  const handleTextSubmit = () => {\r\n    if (!canvasRef.current || !textInput.trim()) {\r\n      setShowTextInput(false);\r\n      return;\r\n    }\r\n    \r\n    // In a real implementation, you would add the text to the canvas at textPosition\r\n    // This is a simplified version that just alerts the text\r\n    alert(`Text to add: ${textInput}`);\r\n    \r\n    setTextInput('');\r\n    setShowTextInput(false);\r\n  };\r\n\r\n  const handleSave = useCallback(() => {\r\n    if (canvas) {\r\n      const data = canvas.getSaveData();\r\n      onSave(data);\r\n    }\r\n  }, [canvas, onSave]);\r\n\r\n  const handleClear = useCallback(() => {\r\n    if (canvas) {\r\n      canvas.clear();\r\n    }\r\n  }, [canvas]);\r\n\r\n  const handleUndo = useCallback(() => {\r\n    if (canvas) {\r\n      canvas.undo();\r\n    }\r\n  }, [canvas]);\r\n\r\n  const handleExport = useCallback(() => {\r\n    if (canvas && canvas.canvas) {\r\n      const dataUrl = (canvas.canvas as any).toDataURL(\"image/png\");\r\n      if (fileDownloadRef.current) {\r\n        fileDownloadRef.current.href = dataUrl;\r\n        fileDownloadRef.current.download = \"whiteboard.png\";\r\n        fileDownloadRef.current.click();\r\n      }\r\n    }\r\n  }, [canvas]);\r\n\r\n  const handleBrushColor = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setBrushColor(e.target.value);\r\n    setActiveTool('pen');\r\n  };\r\n\r\n  const handleBrushRadius = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setBrushRadius(Number(e.target.value));\r\n  };\r\n\r\n  return (\r\n    <div className=\"border rounded-lg p-4 bg-white\">\r\n      <div className=\"flex flex-col gap-4\">\r\n        {/* Toolbar */}\r\n        <div className=\"flex flex-wrap justify-between items-center gap-2\">\r\n          <h3 className=\"text-lg font-semibold\">Whiteboard</h3>\r\n          <div className=\"flex flex-wrap items-center gap-2\">\r\n            {/* Drawing Tools */}\r\n            <div className=\"flex items-center gap-1 p-1 bg-gray-100 rounded-md\">\r\n              <button\r\n                onClick={() => setActiveTool('pen')}\r\n                className={`p-2 rounded ${activeTool === 'pen' ? 'bg-white shadow' : 'hover:bg-gray-200'}`}\r\n                title=\"Pen\"\r\n              >\r\n                <FiPenTool className=\"w-5 h-5\" />\r\n              </button>\r\n              <button\r\n                onClick={() => setActiveTool('eraser')}\r\n                className={`p-2 rounded ${activeTool === 'eraser' ? 'bg-white shadow' : 'hover:bg-gray-200'}`}\r\n                title=\"Eraser\"\r\n              >\r\n                <FiX className=\"w-5 h-5\" />\r\n              </button>\r\n              <button\r\n                onClick={() => setActiveTool('text')}\r\n                className={`p-2 rounded ${activeTool === 'text' ? 'bg-white shadow' : 'hover:bg-gray-200'}`}\r\n                title=\"Add Text\"\r\n              >\r\n                <FiType className=\"w-5 h-5\" />\r\n              </button>\r\n              <button\r\n                onClick={() => setActiveTool('rectangle')}\r\n                className={`p-2 rounded ${activeTool === 'rectangle' ? 'bg-white shadow' : 'hover:bg-gray-200'}`}\r\n                title=\"Rectangle\"\r\n              >\r\n                <FiSquare className=\"w-5 h-5\" />\r\n              </button>\r\n              <button\r\n                onClick={() => setActiveTool('circle')}\r\n                className={`p-2 rounded ${activeTool === 'circle' ? 'bg-white shadow' : 'hover:bg-gray-200'}`}\r\n                title=\"Circle\"\r\n              >\r\n                <FiCircle className=\"w-5 h-5\" />\r\n              </button>\r\n              <button\r\n                onClick={() => setActiveTool('line')}\r\n                className={`p-2 rounded ${activeTool === 'line' ? 'bg-white shadow' : 'hover:bg-gray-200'}`}\r\n                title=\"Line\"\r\n              >\r\n                <FiMinus className=\"w-5 h-5\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Color Picker */}\r\n            <div className=\"relative\">\r\n              <button\r\n                onClick={() => setShowColorPicker(!showColorPicker)}\r\n                className=\"w-8 h-8 rounded border border-gray-300\"\r\n                style={{ backgroundColor: brushColor }}\r\n                title=\"Select color\"\r\n              />\r\n              {showColorPicker && (\r\n                <div className=\"absolute z-10 mt-2 p-2 bg-white rounded shadow-lg\">\r\n                  <div className=\"grid grid-cols-4 gap-2\">\r\n                    {colors.map((color) => (\r\n                      <button\r\n                        key={color}\r\n                        onClick={() => {\r\n                          setBrushColor(color);\r\n                          setShowColorPicker(false);\r\n                          setActiveTool('pen');\r\n                        }}\r\n                        className=\"w-6 h-6 rounded border border-gray-300\"\r\n                        style={{ backgroundColor: color }}\r\n                        title={color}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Brush Size */}\r\n            <div className=\"flex items-center gap-1\">\r\n              <span className=\"text-xs\">Size:</span>\r\n              <select\r\n                value={brushRadius}\r\n                onChange={(e) => setBrushRadius(Number(e.target.value))}\r\n                className=\"text-sm border rounded p-1\"\r\n              >\r\n                {brushSizes.map((size) => (\r\n                  <option key={size} value={size}>\r\n                    {size}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            {/* Action Buttons */}\r\n            <div className=\"flex items-center gap-1\">\r\n              <button\r\n                onClick={handleUndo}\r\n                className=\"p-2 text-gray-700 hover:bg-gray-200 rounded\"\r\n                title=\"Undo\"\r\n              >\r\n                <FiRotateCcw className=\"w-5 h-5\" />\r\n              </button>\r\n              <button\r\n                onClick={handleClear}\r\n                className=\"p-2 text-gray-700 hover:bg-gray-200 rounded\"\r\n                title=\"Clear\"\r\n              >\r\n                <FiTrash2 className=\"w-5 h-5\" />\r\n              </button>\r\n              <button\r\n                onClick={handleSave}\r\n                className=\"p-2 bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n                title=\"Save\"\r\n              >\r\n                <FiSave className=\"w-5 h-5\" />\r\n              </button>\r\n              <button\r\n                onClick={handleExport}\r\n                className=\"p-2 bg-green-500 text-white rounded hover:bg-green-600\"\r\n                title=\"Export\"\r\n              >\r\n                <FiDownload className=\"w-5 h-5\" />\r\n              </button>\r\n              <a ref={fileDownloadRef} style={{ display: 'none' }}>Download</a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Canvas Area */}\r\n        <div \r\n          ref={canvasContainerRef}\r\n          className=\"relative border rounded bg-white\"\r\n          style={{ width: '100%', height: '500px', overflow: 'hidden' }}\r\n          onMouseDown={handleMouseDown}\r\n          onMouseMove={handleMouseMove}\r\n          onMouseUp={handleMouseUp}\r\n          onMouseLeave={handleMouseUp}\r\n        >\r\n          <CanvasDraw\r\n            ref={(canvasDraw: any) => {\r\n              if (canvasDraw) {\r\n                setCanvas(canvasDraw);\r\n                (canvasRef as React.MutableRefObject<any>).current = canvasDraw;\r\n              }\r\n            }}\r\n            brushColor={activeTool === 'eraser' ? '#fff' : brushColor}\r\n            brushRadius={brushRadius}\r\n            lazyRadius={0}\r\n            saveData={initialData}\r\n            style={{\r\n              width: '100%',\r\n              height: '100%',\r\n              touchAction: 'none',\r\n            }}\r\n            canvasWidth={800}\r\n            canvasHeight={500}\r\n          />\r\n          \r\n          {/* Text Input Overlay */}\r\n          {showTextInput && (\r\n            <div\r\n              style={{\r\n                position: 'absolute',\r\n                left: `${textPosition.x}px`,\r\n                top: `${textPosition.y}px`,\r\n                zIndex: 1000,\r\n              }}\r\n            >\r\n              <div className=\"flex bg-white border rounded shadow-lg p-2\">\r\n                <input\r\n                  type=\"text\"\r\n                  value={textInput}\r\n                  onChange={(e) => setTextInput(e.target.value)}\r\n                  onKeyDown={(e) => e.key === 'Enter' && handleTextSubmit()}\r\n                  className=\"border rounded px-2 py-1 mr-2\"\r\n                  autoFocus\r\n                  placeholder=\"Enter text...\"\r\n                />\r\n                <button\r\n                  onClick={handleTextSubmit}\r\n                  className=\"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n                >\r\n                  Add\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DiagramCanvas;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}